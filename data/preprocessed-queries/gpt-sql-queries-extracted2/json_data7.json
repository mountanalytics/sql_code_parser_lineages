{
    "modified_SQL_query": "INSERT INTO PROCESS_DB.market_data_analysis ( stock_id, ticker, sector, total_volume_last_year, avg_closing_price_last_year, max_closing_price_last_year, min_closing_price_last_year, total_trades, avg_trade_value, max_trade_value, min_trade_value, total_dividends_paid, avg_dividend_yield, highest_volume_day, lowest_volume_day, most_recent_closing_price, total_investors, total_portfolios, most_active_investor, least_active_investor ) SELECT md.stock_id, s.ticker, s.sector, SUM(md.volume) FILTER (WHERE md.market_date >= DATEADD(year, -1, GETDATE())) AS total_volume_last_year, AVG(md.closing_price) FILTER (WHERE md.market_date >= DATEADD(year, -1, GETDATE())) AS avg_closing_price_last_year, MAX(md.closing_price) FILTER (WHERE md.market_date >= DATEADD(year, -1, GETDATE())) AS max_closing_price_last_year, MIN(md.closing_price) FILTER (WHERE md.market_date >= DATEADD(year, -1, GETDATE())) AS min_closing_price_last_year, COUNT(t.trade_id) AS total_trades, AVG(t.quantity * t.price_per_share) AS avg_trade_value, MAX(t.quantity * t.price_per_share) AS max_trade_value, MIN(t.quantity * t.price_per_share) AS min_trade_value, SUM(d.dividend_amount * t.quantity) AS total_dividends_paid, AVG(CASE WHEN md.closing_price > 0 THEN d.dividend_amount / md.closing_price ELSE 0 END) AS avg_dividend_yield, subquery1_1 AS highest_volume_day, subquery1_2 AS lowest_volume_day, subquery1_3 AS most_recent_closing_price, COUNT(DISTINCT i.investor_id) AS total_investors, COUNT(DISTINCT p.portfolio_id) AS total_portfolios, subquery1_4 AS most_active_investor, subquery1_5 AS least_active_investor FROM SOURCE_DB.market_data md JOIN SOURCE_DB.stocks s ON md.stock_id = s.stock_id JOIN SOURCE_DB.trades t ON s.stock_id = t.stock_id JOIN SOURCE_DB.portfolios p ON t.portfolio_id = p.portfolio_id JOIN SOURCE_DB.investors i ON p.investor_id = i.investor_id JOIN SOURCE_DB.dividends d ON s.stock_id = d.stock_id GROUP BY md.stock_id, s.ticker, s.sector",
    "subquery_dictionary": {
        "subquery1_1": "SELECT md1.market_date FROM SOURCE_DB.market_data md1 WHERE md1.stock_id = md.stock_id ORDER BY md1.volume DESC LIMIT 1",
        "subquery1_2": "SELECT md1.market_date FROM SOURCE_DB.market_data md1 WHERE md1.stock_id = md.stock_id ORDER BY md1.volume ASC LIMIT 1",
        "subquery1_3": "SELECT md1.closing_price FROM SOURCE_DB.market_data md1 WHERE md1.stock_id = md.stock_id ORDER BY md1.market_date DESC LIMIT 1",
        "subquery1_4": "SELECT i.investor_id FROM SOURCE_DB.trades t1 JOIN SOURCE_DB.portfolios p ON t1.portfolio_id = p.portfolio_id JOIN SOURCE_DB.investors i ON p.investor_id = i.investor_id WHERE t1.stock_id = s.stock_id GROUP BY i.investor_id ORDER BY COUNT(t1.trade_id) DESC LIMIT 1",
        "subquery1_5": "SELECT i.investor_id FROM SOURCE_DB.trades t1 JOIN SOURCE_DB.portfolios p ON t1.portfolio_id = p.portfolio_id JOIN SOURCE_DB.investors i ON p.investor_id = i.investor_id WHERE t1.stock_id = s.stock_id GROUP BY i.investor_id ORDER BY COUNT(t1.trade_id) ASC LIMIT 1"
    }
}