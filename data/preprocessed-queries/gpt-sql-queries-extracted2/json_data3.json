{
    "modified_SQL_query": "INSERT INTO PROCESS_DB.detailed_investor_info ( investor_id, first_name, last_name, email, join_date, portfolio_id, portfolio_name, account_id, account_balance, total_trades, total_trade_value, total_dividends, avg_trade_value, max_trade_value, min_trade_value, stock_count, most_recent_trade_date, oldest_trade_date, avg_stock_price, total_investment_value ) SELECT i.investor_id, i.first_name, i.last_name, i.email, i.join_date, p.portfolio_id, p.portfolio_name, a.account_id, a.balance AS account_balance, COUNT(t.trade_id) AS total_trades, SUM(t.quantity * t.price_per_share) AS total_trade_value, SUM(d.dividend_amount * t.quantity) AS total_dividends, AVG(t.quantity * t.price_per_share) AS avg_trade_value, MAX(t.quantity * t.price_per_share) AS max_trade_value, MIN(t.quantity * t.price_per_share) AS min_trade_value, COUNT(DISTINCT t.stock_id) AS stock_count, MAX(t.trade_date) AS most_recent_trade_date, MIN(t.trade_date) AS oldest_trade_date, AVG(md.closing_price) AS avg_stock_price, SUM(t.quantity * md.closing_price) AS total_investment_value FROM SOURCE_DB.investors i JOIN SOURCE_DB.portfolios p ON i.investor_id = p.investor_id JOIN SOURCE_DB.accounts a ON p.portfolio_id = a.portfolio_id JOIN SOURCE_DB.trades t ON p.portfolio_id = t.portfolio_id JOIN SOURCE_DB.dividends d ON t.stock_id = d.stock_id JOIN SOURCE_DB.market_data md ON t.stock_id = md.stock_id WHERE i.join_date <= DATEADD(year, -1, GETDATE()) GROUP BY i.investor_id, i.first_name, i.last_name, i.email, i.join_date, p.portfolio_id, p.portfolio_name, a.account_id, a.balance",
    "subquery_dictionary": {}
}